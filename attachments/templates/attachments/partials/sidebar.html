<!-- templates/attachments/partials/sidebar.html -->
<div class="col-lg-2 col-md-3 d-md-block sidebar collapse bg-dark text-white">
    <div class="position-sticky pt-3">
        <ul class="nav flex-column">
            <li class="nav-item">
                <a class="nav-link {% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}" 
                   href="{% url 'attachments:dashboard' %}">
                    <i class="fas fa-tachometer-alt me-2"></i>
                    Dashboard
                </a>
            </li>
            
            <!-- Logbook link with safe handling -->
            <li class="nav-item">
                {% if current_attachment %}
                <a class="nav-link {% if request.resolver_match.url_name == 'logbook' %}active{% endif %}" 
                   href="{% url 'attachments:logbook' attachment_id=current_attachment.id %}">
                    <i class="fas fa-book me-2"></i>
                    Logbook
                </a>
                {% else %}
                <a class="nav-link text-muted disabled" href="#">
                    <i class="fas fa-book me-2"></i>
                    Logbook
                </a>
                {% endif %}
            </li>
            
            <!-- Report Upload link with safe handling -->
            <li class="nav-item">
                {% if current_attachment %}
                <a class="nav-link {% if request.resolver_match.url_name == 'report_upload' %}active{% endif %}" 
                   href="{% url 'attachments:report_upload' attachment_id=current_attachment.id %}">
                    <i class="fas fa-file-upload me-2"></i>
                    Report Upload
                </a>
                {% else %}
                <a class="nav-link text-muted disabled" href="#">
                    <i class="fas fa-file-upload me-2"></i>
                    Report Upload
                </a>
                {% endif %}
            </li>
            
            <li class="nav-item">
                <a class="nav-link {% if request.resolver_match.url_name == 'assessment' %}active{% endif %}" 
                   href="{% url 'attachments:assessment' %}">
                    <i class="fas fa-chart-line me-2"></i>
                    Assessment
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link {% if request.resolver_match.url_name == 'communication' %}active{% endif %}" 
                   href="{% url 'attachments:communication' %}">
                    <i class="fas fa-file-alt me-2"></i>
                    Placement Form
                </a>
            </li>
            
            {% if user.user_type == 2 or user.user_type == 3 %}
            <li class="nav-item mt-4">
                <a class="nav-link text-warning" href="{% url 'evaluations:supervisor_dashboard' %}">
                    <i class="fas fa-clipboard-check me-2"></i>
                    Evaluation Portal
                </a>
            </li>
            {% endif %}
        </ul>
        
        <hr class="bg-secondary">
        
        <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
            <span>My Attachments</span>
        </h6>
        <ul class="nav flex-column mb-2">
            {% for attachment in attachments %}
            <li class="nav-item">
                <a class="nav-link {% if current_attachment and attachment.id == current_attachment.id %}active{% endif %}" 
                   href="#">
                    <i class="fas fa-building me-2"></i>
                    {{ attachment.organization }}
                </a>
            </li>
            {% empty %}
            <li class="nav-item">
                <a class="nav-link text-muted" href="#">
                    <i class="fas fa-info-circle me-2"></i>
                    No attachments yet
                </a>
            </li>
            {% endfor %}
        </ul>
    </div>
</div>